/*! ember-encore - v0.0.7 - 2014-06-03
 * http://github.com/mirego/ember-encore
 *
 * Copyright (c) 2014 Mirego <http://mirego.com>;
 * Licensed under the New BSD license */

!function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("ember-encore",[],b):a.EmberEncore=b()}(this,function(){var EmberEncore={};Ember.onLoad("Ember.Application",function(a){a.initializer({name:"EmberEncore",initialize:function(a){a.register("serializer:-encore",EmberEncore.Serializer),a.register("adapter:-encore",EmberEncore.Adapter)}})}),EmberEncore.Adapter=DS.RESTAdapter.extend({defaultSerializer:"-encore",pathForType:function(a){return Ember.String.pluralize(Ember.String.underscore(a))},ajaxError:function(a){var b=this._super(a),c=JSON.parse(a.responseText);if(a&&422===a.status){var d=c.errors.reduce(function(a,b){return a[b.field]=b.types[0],a},{});return new DS.InvalidError(d)}return b}});var a=Ember.get,b=Ember.isNone,c=Ember.isArray,d=Ember.String.camelize,e=Ember.String.underscore,f=Ember.String.classify,g=Ember.String.pluralize,h=Ember.String.singularize;return EmberEncore.Serializer=DS.RESTSerializer.extend({camelizeKeys:function(a){for(var b in a){var c=d(b);c!=b&&(a[c]=a[b],delete a[b])}},extract:function(a,b,c,d,e){return delete c.links,this.extractLinked(c),this._super(a,b,c,d,e)},extractSingle:function(a,b,d,e,f){var g=b.typeKey;for(var i in d){var j=h(i);if(j===g&&c(d[i])){d[j]=d[i][0];break}}return delete d[i],this._super(a,b,d,e,f)},extractLinks:function(a,b){for(var c in b.links){var e=b.links[c],f=d(c);if(e&&e.href){var g=a.store.adapterFor(a).namespace;b.links[f]="/"+g+e.href,f!=c&&delete b.links[c]}else b[f]=b.links[c],delete b.links[c]}0===Ember.keys(b.links).length&&delete b.links},extractLinked:function(a){for(var b in a.linked)a[b]=a.linked[b];delete a.linked},normalize:function(a,b){return b=this._super(a,b),b&&b.links&&this.extractLinks(a,b),this.camelizeKeys(b),b},extractMeta:function(a,b,c){for(var d in c.meta){var e=c.meta[d];this.camelizeKeys(e),a.metaForType(b,e)}delete c.meta},serializeIntoHash:function(a,b,c,d){a[g(b.typeKey)]=[this.serialize(c,d)]},keyForAttribute:function(a){return e(a)},serializeBelongsTo:function(c,d,f){var g=f.key,h=a(c,g);g=this.keyForRelationship?this.keyForRelationship(g,"belongsTo"):g,d.links||(d.links={}),d.links[e(g)]=b(h)?null:a(h,"id"),delete d[g]},serializePolymorphicType:function(b,c,d){var e=d.key,g=a(b,e);e=this.keyForAttribute?this.keyForAttribute(e):e,c[e+"_type"]=f(g.constructor.typeKey),delete c[d.key]}}),EmberEncore});